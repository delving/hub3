// Code generated by oto; DO NOT EDIT.

package generated

import (
	"context"
	"net/http"

	"github.com/pacedotdev/oto/otohttp"

	domain "github.com/delving/hub3/ikuzo/domain"
)

// NamespaceService allows you to programmatically manage namespaces
type NamespaceService interface {

	// GetNamespace gets a Namespace
	GetNamespace(context.Context, GetNamespaceRequest) (*GetNamespaceResponse, error)
	// ListNamespace returns a list of all namespaces
	ListNamespace(context.Context, ListNamespaceRequest) (*ListNamespaceResponse, error)
}

type namespaceServiceServer struct {
	server           *otohttp.Server
	namespaceService NamespaceService
}

// Register adds the NamespaceService to the otohttp.Server.
func RegisterNamespaceService(server *otohttp.Server, namespaceService NamespaceService) {
	handler := &namespaceServiceServer{
		server:           server,
		namespaceService: namespaceService,
	}
	server.Register("NamespaceService", "GetNamespace", handler.handleGetNamespace)
	server.Register("NamespaceService", "ListNamespace", handler.handleListNamespace)
}

func (s *namespaceServiceServer) handleGetNamespace(w http.ResponseWriter, r *http.Request) {
	var request GetNamespaceRequest
	if err := otohttp.Decode(r, &request); err != nil {
		s.server.OnErr(w, r, err)
		return
	}
	response, err := s.namespaceService.GetNamespace(r.Context(), request)
	if err != nil {
		s.server.OnErr(w, r, err)
		return
	}
	if err := otohttp.Encode(w, r, http.StatusOK, response); err != nil {
		s.server.OnErr(w, r, err)
		return
	}
}

func (s *namespaceServiceServer) handleListNamespace(w http.ResponseWriter, r *http.Request) {
	var request ListNamespaceRequest
	if err := otohttp.Decode(r, &request); err != nil {
		s.server.OnErr(w, r, err)
		return
	}
	response, err := s.namespaceService.ListNamespace(r.Context(), request)
	if err != nil {
		s.server.OnErr(w, r, err)
		return
	}
	if err := otohttp.Encode(w, r, http.StatusOK, response); err != nil {
		s.server.OnErr(w, r, err)
		return
	}
}

// GetNamespaceRequest is the input object for GetNamespaceRequest.
type GetNamespaceRequest struct {
	// Prefix is the prefix of the Namespace
	Prefix string `json:"prefix"`
}

// GetNamespaceResponse is the output object for GetNamespaceRequest.
type GetNamespaceResponse struct {
	// Namespaces are the namespaces that match the GetNamespaceRequest.Prefix
	Namespaces []*domain.Namespace `json:"namespaces"`
	// Error is string explaining what went wrong. Empty if everything was fine.
	Error string `json:"error,omitempty"`
}

// ListNamespaceRequest is the input object for ListNamespaceRequest.
type ListNamespaceRequest struct {
	// Prefix is the prefix of the Namespace
	Prefix string `json:"prefix"`
	// Base is the base URI of the Namespace
	Base string `json:"base"`
}

// ListNamespaceResponse is the output object for ListNamespaceRequest.
type ListNamespaceResponse struct {
	// Namespaces are the namespaces that match the ListNamespaceRequest Prefix or Base
	Namespaces []*domain.Namespace `json:"namespaces"`
	// Error is string explaining what went wrong. Empty if everything was fine.
	Error string `json:"error,omitempty"`
}
